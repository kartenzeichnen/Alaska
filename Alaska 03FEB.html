<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Alaska Earthquake Map</title>
    
    <!-- Using Cloudflare CDN for Leaflet CSS - often more reliable on GitHub -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com" />
    
    <!-- Leaflet JS -->
    <script src="https://cdnjs.cloudflare.com"></script>
    
    <!-- PapaParse JS -->
    <script src="https://cdnjs.cloudflare.com"></script>

    <style>
        /* Ensuring the map fills the screen even if the external CSS is slow */
        html, body { height: 100%; margin: 0; padding: 0; }
        #mapdiv { height: 100vh; width: 100%; background: #ddd; }
    </style>
</head>
<body>

<div id="mapdiv"></div>

<script>
    // Initialize map
    var mymap = L.map('mapdiv').setView([64.0, -150.0], 4);

    // Using HTTPS and a standard tile provider
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '&copy; OpenStreetMap contributors'
    }).addTo(mymap);

    // Load CSV
    Papa.parse("Alaska Earthquakes to Print.csv", {
        download: true,
        header: true,
        dynamicTyping: true,
        complete: function(results) {
            console.log("Found " + results.data.length + " rows in CSV");
            results.data.forEach(function(row) {
                if (row.latitude && row.longitude) {
                    // Radius = depth (km) * 500 (meters)
                    var depthRadius = (row.depth > 0) ? row.depth * 500 : 500;
                    
                    L.circle([row.latitude, row.longitude], {
                        radius: depthRadius,
                        color: 'red',
                        weight: 1,
                        fillOpacity: 0.4
                    })
                    .bindPopup("<b>" + row.place + "</b><br>Depth: " + row.depth + "km")
                    .addTo(mymap);
                }
            });
        }
    });
</script>
</body>
</html>