<!doctype html>
<html lang="en">
<head>
    <title>Alaska Earthquake Map</title>
    <!-- Leaflet CSS & JS -->
    <link rel="stylesheet" href="https://unpkg.com" />
    <script src="https://unpkg.com"></script>
    
    <!-- FIXED PapaParse Library Link -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>

    <style>
        body { margin:0; padding:0; }
        #mapdiv { position:absolute; top:0; bottom:0; width:100%; }
    </style>
</head>
<body>

<div id="mapdiv"></div>

<script>
    // Adjust view to show more of Alaska
    var mymap = L.map('mapdiv').setView([64.0, -150.0], 4);

    // FIXED: Changed 'http' to 'https' to prevent GitHub security blocks
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        maxZoom: 18,
        attribution: 'Map data &copy; <a href="https://openstreetmap.org">OpenStreetMap</a>'
    }).addTo(mymap);

    function loadCSV() {
        // Ensure this filename matches EXACTLY what you uploaded to GitHub
        Papa.parse("Alaska Earthquakes to Print.csv", {
            download: true,
            header: true,
            dynamicTyping: true,
            complete: function(results) {
                console.log("Data loaded:", results.data.length, "rows");
                results.data.forEach(function(row) {
                    // Check if latitude and longitude exist in this row
                    if (row.latitude && row.longitude) {
                        L.circle([row.latitude, row.longitude], {
                            radius: (row.depth || 1) * 500, // Multiplier for visibility
                            color: 'red',
                            fillColor: '#f03',
                            fillOpacity: 0.5
                        })
                        .bindPopup(`<b>Location:</b> ${row.place}<br>
                                    <b>Magnitude:</b> ${row.magnitude}<br>
                                    <b>Depth:</b> ${row.depth} km`)
                        .addTo(mymap);
                    }
                });
            },
            error: function(err) {
                console.error("Error loading CSV:", err);
            }
        });
    }

    loadCSV();
</script>
</body>
</html>