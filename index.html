

<!doctype html>
<html lang="en">
<head>
    <title>Alaska Earthquake Map</title>

    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

    <!-- PapaParse -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>

    <style>
        body { margin:0; padding:0; }
        #mapdiv { height: 100vh; width: 100vw; }

.legend {
    background: white;
    padding: 10px;
    line-height: 18px;
    color: #333;
    border-radius: 5px;
    box-shadow: 0 0 15px rgba(0,0,0,0.2);
}

.legend h4 {
    margin: 0 0 5px;
    font-size: 14px;
}

.legend i {
    width: 18px;
    height: 18px;
    float: left;
    margin-right: 8px;
    opacity: 0.8;
}


.compass-rose {
    background: white;
    padding: 6px;
    border-radius: 6px;
    box-shadow: 0 0 8px rgba(0,0,0,0.3);
}






    </style>


</head>
<body>

<div id="mapdiv"></div>

<script>
    var map = L.map('mapdiv').setView([58.0, -150.0], 6);

    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        maxZoom: 18,
        attribution: '&copy; OpenStreetMap'
    }).addTo(map);


L.control.scale({
    position: 'bottomleft',
    imperial: true,  // miles
    metric: true     // kilometers
}).addTo(map);




var compassRose = L.control({ position: 'bottomleft' });

compassRose.onAdd = function (map) {
    var div = L.DomUtil.create('div', 'compass-rose');

    div.innerHTML = `
    <svg width="80" height="80" viewBox="0 0 200 200" aria-label="Compass Rose">

        <!-- Outer rings -->
        <circle cx="100" cy="100" r="95" fill="white" stroke="black" stroke-width="3"/>
        <circle cx="100" cy="100" r="85" fill="none" stroke="black" stroke-width="1"/>

        <!-- Star points -->
        <g transform="translate(100 100)">
            <!-- Cardinal points -->
            <g fill="black">
                <polygon points="0,-80 -10,0 0,-15 10,0"/>
                <polygon points="80,0 0,-10 15,0 0,10"/>
                <polygon points="0,80 -10,0 0,15 10,0"/>
                <polygon points="-80,0 0,-10 -15,0 0,10"/>
            </g>

            <!-- Intercardinal points -->
            <g fill="#cc3333">
                <g transform="rotate(45)">
                    <polygon points="0,-60 -7,0 0,-12 7,0"/>
                </g>
                <g transform="rotate(135)">
                    <polygon points="0,-60 -7,0 0,-12 7,0"/>
                </g>
                <g transform="rotate(225)">
                    <polygon points="0,-60 -7,0 0,-12 7,0"/>
                </g>
                <g transform="rotate(315)">
                    <polygon points="0,-60 -7,0 0,-12 7,0"/>
                </g>
            </g>
        </g>

        <!-- Cardinal labels -->
        <text x="100" y="30" text-anchor="middle"
              font-size="18" font-weight="bold">N</text>
        <text x="170" y="105" text-anchor="middle"
              font-size="16">E</text>
        <text x="100" y="185" text-anchor="middle"
              font-size="16">S</text>
        <text x="30" y="105" text-anchor="middle"
              font-size="16">W</text>

        <!-- Center dot -->
        <circle cx="100" cy="100" r="4" fill="black"/>

    </svg>
    `;

    return div;
};

compassRose.addTo(map);



function getColor(depth) {
    if (depth <= 40) return "#ffff66";   // yellow
    if (depth <= 90) return "#3399ff";   // blue
    if (depth <= 140) return "#ff9933";  // orange
    return "#9933cc";                    // purple

    }


var legend = L.control({ position: "bottomright" });

legend.onAdd = function (map) {
    var div = L.DomUtil.create("div", "info legend");

    div.innerHTML = `
        <h4>Earthquake Depth (km)</h4>
        <i style="background:#ffff66"></i> 0–40<br>
        <i style="background:#3399ff"></i> 40.1–90<br>
        <i style="background:#ff9933"></i> 90.1–140<br>
        <i style="background:#9933cc"></i> > 140.1
    `;

    return div;
};

legend.addTo(map);



    Papa.parse("Alaska Earthquakes to Print.csv", {
        download: true,
        header: true,
        dynamicTyping: true,
        complete: function(results) {

results.data.forEach(function(eq) {

    const lat = Number(eq.latitude);
    const lon = Number(eq.longitude);
    const mag = Number(eq.mag);
    const depth = Number(eq.depth);

    // Skip invalid rows
    if (
        !isFinite(lat) ||
        !isFinite(lon) ||
        !isFinite(mag) ||
        !isFinite(depth)
    ) {
        return;
    }

    L.circleMarker([lat, lon], {
        radius: Math.max(mag * 1.1, 2), // prevent zero/NaN radius
        color: getColor(depth),
        fillOpacity: 0.7
    })
    .bindPopup(`
        <b>Magnitude:</b> ${mag}<br>
        <b>Depth:</b> ${depth} km
    `)
    .addTo(map);
});

        }
    });
</script>

</body>
</html>